<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
  <title>The Hoang</title></title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
  <link rel="stylesheet" href="/assets/css/main.css" />
  <!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
  <!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
</head>


<body>

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Main -->
        <div id="main">
            <div class="inner">

                <!-- Header -->
  <header id="header">
    <!--
    <a href="" class="logo"><strong>Editorial</strong> by HTML5 UP</a>
    -->
    <ul class="icons">
      <!--
      
      <li><a href="https://twitter.com/andrewbanchich" class="icon fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
      
      
      <li><a href="https://plus.google.com/u/0/+AndrewBanchich" class="icon fa-google-plus" target="_blank"><span class="label">Google+</span></a></li>
      
      
      
      <li><a href="https://instagram.com" class="icon fa-instagram" target="_blank"><span class="label">Instagram</span></a></li>
      
      
      
      
      <li><a href="https://gitlab.com/u/andrewbanchich" class="icon fa-gitlab" target="_blank"><span class="label">GitLab</span></a></li>
      
      
      
      -->
      <li><a href="https://www.youtube.com/channel/UCC6FiLpZT2Yq7P1SCfOgRUw/videos" class="icon fa-youtube" target="_blank"><span class="label">Youtube</span></a></li>
      <li><a href="https://myanimelist.net/animelist/thelovebaby6" class="icon fa-tv" target="_blank"><span class="label">MyAnimeList</span></a></li>
      <li><a href="https://steamcommunity.com/profiles/76561198135355531" class="icon fa-steam" target="_blank"><span class="label">MyAnimeList</span></a></li>
      
      <li><a href="https://www.linkedin.com/in/thehoang1920/" class="icon fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
      
    </ul>
  </header>


                <!-- Content -->
                <section>
                	<header class="main">
                		<h1>3-PFsense IP and DNS filter with PFBLOCKERNG / Application Filter with Snort and OpenAppID</h1>
                	</header>

                  

                <meta charset="utf-8" />

<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

<meta name="apple-mobile-web-app-capable" content="yes" />

<meta name="apple-mobile-web-app-status-bar-style" content="black" />

<meta name="mobile-web-app-capable" content="yes" />

<title></title>

<link rel="icon" type="image/png" href="https://hackmd.io/favicon.png" />

<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />

<style type="text/css">@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p:last-child{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p:last-child,.markdown-body .alert>ul:last-child{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.figma{display:table;position:relative;width:100%;padding-bottom:56.25%}.figma iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;border:1px solid #eee}.markmap-container{height:300px}.markmap-container>svg{width:100%;height:100%}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ãƒ’ãƒ©ã‚®ãƒŽè§’ã‚´ Pro W3,Osaka,Meiryo,ãƒ¡ã‚¤ãƒªã‚ª,MS Gothic,ï¼­ï¼³\ ã‚´ã‚·ãƒƒã‚¯,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,å¾®è»Ÿæ­£é»‘,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,å¾®è½¯é›…é»‘,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ãƒ’ãƒ©ã‚®ãƒŽè§’ã‚´ Pro W3,Osaka,Meiryo,ãƒ¡ã‚¤ãƒªã‚ª,MS Gothic,ï¼­ï¼³\ ã‚´ã‚·ãƒƒã‚¯,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,å¾®è»Ÿæ­£é»‘,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,å¾®è½¯é›…é»‘,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ï¼­ï¼³\ ï¼°ã‚´ã‚·ãƒƒã‚¯,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,å¾®è»Ÿæ­£é»‘UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,å¾®è½¯é›…é»‘UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ï¼­ï¼³\ ï¼°ã‚´ã‚·ãƒƒã‚¯,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,å¾®è»Ÿæ­£é»‘UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,å¾®è½¯é›…é»‘UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:50%;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;text-decoration:none;padding-left:22px}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ãƒ’ãƒ©ã‚®ãƒŽè§’ã‚´ Pro W3,Osaka,Meiryo,ãƒ¡ã‚¤ãƒªã‚ª,MS Gothic,ï¼­ï¼³\ ã‚´ã‚·ãƒƒã‚¯,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,å¾®è»Ÿæ­£é»‘,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,å¾®è½¯é›…é»‘,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em;font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ãƒ’ãƒ©ã‚®ãƒŽè§’ã‚´ Pro W3,Osaka,Meiryo,ãƒ¡ã‚¤ãƒªã‚ª,MS Gothic,ï¼­ï¼³\ ã‚´ã‚·ãƒƒã‚¯,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,å¾®è»Ÿæ­£é»‘,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,å¾®è½¯é›…é»‘,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}</style>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->

<div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><h1 id="PFsense-IP-and-DNS-filter-with-PFBLOCKERNG--Application-Filter-with-Snort-and-OpenAppID" data-id="PFsense-IP-and-DNS-filter-with-PFBLOCKERNG--Application-Filter-with-Snort-and-OpenAppID"><span>Source</span></h1><p><span>Today I will show you guys how to filter website with PFBLOCKERNG on pfsense</span><br /><span>I use sources below as reference:</span></p><ul><li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=7_yI1FEw_j0"><span>https://www.youtube.com/watch?v=7_yI1FEw_j0</span></a></li><li><a target="_blank" rel="noopener" href="https://www.privacyaffairs.com/ip-filtering-pfsense/"><span>https://www.privacyaffairs.com/ip-filtering-pfsense/</span></a></li><li><a target="_blank" rel="noopener" href="https://digitalavenue.dev/How_To_Setup_Intrusion_Detection_Using_Snort_on_PfSense/"><span>https://digitalavenue.dev/How_To_Setup_Intrusion_Detection_Using_Snort_on_PfSense/</span></a></li></ul><h2 id="Requirement" data-id="Requirement"><span>Requirement</span></h2><h3 id="System-Requirement" data-id="System-Requirement"><span>System Requirement</span></h3><ul><li><span>Pfsense Firewall</span></li><li><span>PFBLOCKERNG package</span></li><li><span>Snort package</span></li></ul><h2 id="Install-PFBLOCKERNG" data-id="Install-PFBLOCKERNG"><span>Install PFBLOCKERNG</span></h2><h3 id="Install-pfBlockerNG-deval" data-id="Install-pfBlockerNG-deval"><span>Install pfBlockerNG-deval</span></h3><ul><li><span>System &gt; Package Manager &gt; pfBlockerNG-devel</span></li></ul><p><span>While the &ldquo;devel&rdquo; suffix stands for development version (i.e., beta software), it is fully functional and is being actively developed. It will be in perpetual beta as the package developer feels it&rsquo;s safer to consider it as beta software as he continually adds new functionality to the package.</span></p><h2 id="Configure-PFBLOCKERNG" data-id="Configure-PFBLOCKERNG"><span>Configure PFBLOCKERNG</span></h2><h3 id="Basic-Setup" data-id="Basic-Setup"><span>Basic Setup</span></h3><ul><li><span>Firewall &gt; pfBlockerNG</span></li><li><span>Click Here to configure pfBlockerNG manually</span></li><li><span>Gerneral tab:</span><ul><li><span>tick on enable pfBlockerNG. Everything else is default</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/huN6I2N.png" /></li></ul></li><li><span>IP Tab</span><ul><li><span>tick on enable De-Duplication, CIDR Aggregation and Suppression. Everything else is default</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/l3EgD7Q.png" /></li><li><span>MaxMind GeoIP configuration (optional): the GeoIP feature of pfBlockerNG enables you to filter traffic to and from entire countries or continents. To do this, pfBlocker uses the MaxMind GeoIP database, which requires a license key. There is a link in the MaxMind License Key field description that takes you to the MaxMind registration page. The MaxMind license key is free. If you intend to use this feature, then register with Maxmind and obtain the License Key for FREE</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/4T7tLKe.png" /></li><li><span>On IP/interface/Rules Configuration section:</span><ul><li><span>Inbound Firewall Rules: WAN</span></li><li><span>OUtbound Firewall Rules: LAN</span></li><li><span>Floating Rules: Enable</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/IcsBnRY.png" /></li></ul></li></ul></li></ul><h3 id="IP-Block-Optional" data-id="IP-Block-Optional"><span>IP Block (Optional)</span></h3><ul><li><span>Feed tab, pfBlockerNG/IP/IPv4:</span><ul><li><span>Click the blue +, next to PRI1</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/3QyCzOT.png" /></li><li><span>Delete Pulsedive Source Definitions and set all setting to ON</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/6E6NNNC.png" /><br /><img alt="" loading="lazy" src="https://i.imgur.com/BNa8Shn.png" /></li><li><span>On Settings section, tick on Deny Both on Action. This will block traffic to and from the IP addresses contained in the lists/feeds. You can choose only to deny inbound or outbound connections if you like</span></li><li><img alt="" loading="lazy" src="https://i.imgur.com/34gGnMw.png" /></li></ul></li><li><span>Update Tab</span><ul><li>Select &lsquo;Force&rsquo; option : Update. And Run Update</li></ul></li><li><span>IP/GeoIP Tab</span><ul><li><span>You can try to Allow/Deny connect to and from those contry</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/dDErY4h.png" /></li></ul></li></ul><h3 id="DNS-Block-Basic" data-id="DNS-Block-Basic"><span>DNS Block Basic</span></h3><ul><li><span>DNSBL Tab</span><ul><li><span>DNSBL Section</span><ul><li><span>Enable DNSBL</span></li><li><span>DNSBL Mode: Unbound python mode</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/OfkZe7F.png" /></li></ul></li><li><span>DNSBL Configuration</span><ul><li><span>Enable Permit Firewall Rules</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/wAQton6.png" /></li></ul></li><li><span>DNSBL Groups section</span><ul><li><span>Add New group name</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/1wHEsqU.png" /></li><li><span>Consider custom list at : </span><a target="_blank" rel="noopener" href="https://github.com/StevenBlack/hosts"><span>https://github.com/StevenBlack/hosts</span></a></li><li><span>Add the list url in Source, name Header and turn it on</span></li><li><span>Set Action to "<strong>Unbound</strong>"</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/8Pxo2zt.png" /></li><li><span>DNSBL Custom_List: Add additional domain that you want to block (note: this only work on simple domain, not complication domain with many-subdomain)</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/qnmK0vN.png" /></li><li><span>Save Setting</span></li></ul></li></ul></li><li><span>Update Tab</span><ul><li><span>Select <strong>Force&nbsp;</strong>option: Update</span></li><li><span>Select <strong>Reload</strong>&nbsp;option : DNSBL</span></li><li><span>Run</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/A7XxVjp.png" /></li></ul></li><li><span>Testing</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/TJFriJg.png" /><br /><img alt="" loading="lazy" src="https://i.imgur.com/ry23olT.png" /></li></ul><h3 id="DNS-Block-Advance" data-id="DNS-Block-Advance"><span>DNS Block Advance</span></h3><p><span>This section is for blocking huge domain with many sub-domain website like Youtube, Facebook, etc</span></p><ul><li><span>DNSBL Tab</span><ul><li><span>DNSBL Section</span><ul><li><span>Enable DNSBL</span></li><li><span>DNSBL Mode: Unbound python mode</span></li><li><span>Wildcard Blocking (TLD): </span><strong><span>Enable</span></strong><br /><img alt="" loading="lazy" src="https://i.imgur.com/PAghnen.png" /></li></ul></li><li><span>TLD Blacklist/Whitelist</span><ul><li><span>TLD Blacklist: add the domain that you want to block</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/WiTuTkf.png" /></li></ul></li></ul></li><li><span>Update Tab</span><ul><li><span>Select <strong>Force</strong>&nbsp;option: Update</span></li><li><span>Select <strong>Reload&nbsp;</strong>option : DNSBL</span></li><li><span>Run</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/A7XxVjp.png" /></li></ul></li><li><span>Testing</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/TJFriJg.png" /><br /><img alt="" loading="lazy" src="https://i.imgur.com/ry23olT.png" /></li></ul><h3 id="Testing" data-id="Testing"><span>Testing</span></h3><p><img alt="" loading="lazy" src="https://i.imgur.com/M53jDhr.png" /></p><h3 id="Note" data-id="Note"><span>Note</span></h3><h4 id="Block-user-from-change-DNS-setting" data-id="Block-user-from-change-DNS-setting"><span>Block user from change DNS setting</span></h4><p><span>By default normal user should be prohibit from changeing LAN connection properties. However, if for some reason they are not, you can enable GPO to restrict them</span><br /><a target="_blank" rel="noopener" href="https://technet2u.com/prohibit-access-to-lan-connection-properties-in-windows-7/"><span>https://technet2u.com/prohibit-access-to-lan-connection-properties-in-windows-7/</span></a></p><h2 id="Install-Snort" data-id="Install-Snort"><span>Install Snort</span></h2><h3 id="Install-Snort1" data-id="Install-Snort"><span>Install Snort</span></h3><ul><li><span>System &gt; Package Manager &gt; snort</span></li></ul><p><img alt="" loading="lazy" src="https://i.imgur.com/2HccuQ6.jpg" /><br /><img alt="" loading="lazy" src="https://i.imgur.com/ZNCozAi.jpg" /></p><h2 id="Configure-Snort" data-id="Configure-Snort"><span>Configure Snort</span></h2><h3 id="Basic-Setup1" data-id="Basic-Setup"><span>Basic Setup</span></h3><p><span>Services &gt; Snort</span></p><ul><li><p><span>Global Settings tab:</span></p><ul><li><span>Snort VRT : Enabled</span></li><li><span>Snort Oinkmaster Code: use can you this link </span><a target="_blank" rel="noopener" href="https://www.snort.org/"><span>https://www.snort.org/</span></a><span> to register an account for free and get the oinkcode</span></li><li><span>Snort GPLv2 : Enabled</span></li><li><span>Emergin Threats (ET) Open : Enabled</span></li><li><span>OpenAppIP : Enabled</span></li><li><span>RULES OpenAppID : Enabled</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/glJgGSk.jpg" /></li></ul></li><li><p><span>Updates Tab: It will download all required rules automatically. Initially this take a little logner time. wait untill it completed.</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/y6e0dSt.jpg" /><br /><img alt="" loading="lazy" src="https://i.imgur.com/x601WNZ.jpg" /></p></li><li><p><span>Snort Interfaces Tab:</span></p><ul><li><span>Add New interface</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/jSTUOIt.jpg" /><ul><li><p><span>Enable Interface</span></p></li><li><p><span>Always selecet WAN Interface</span></p></li><li><p><span>Provide a Description</span></p></li><li><p><span>Send Alterts to System Logs</span></p></li><li><p><span>Block Offenders : Enabled</span></p></li><li><p><span>Kill States: Enabled</span></p></li><li><p><span>Search Optimize: Enable search optimization</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/tncWEkW.png" /></p></li><li><p><span>Click Save to finish</span></p></li></ul></li><li><span>Click Start to enable snort on WAN</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/DQNLs93.jpg" /></li></ul></li></ul><h3 id="Configure-Rules-to-block-Application" data-id="Configure-Rules-to-block-Application"><span>Configure Rules to block Application</span></h3><p><span>Click on the Edit button on WAN rule</span></p><ul><li><span>WAN Categories Tab :</span><ul><li><span>Resolve Flowbits: Enabled</span></li><li><span>Use IPS Policy : Enabled</span></li><li><span>IPS Policy Selection: Secuirty</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/V2YFSMu.jpg" /></li><li><span>Select the rule sets : For demonstrate purpose I choose 3 follow rules</span><ul><li><span>openappid-messaging.rule : To block Message app</span></li><li><span>openappid-social_networking.rules: To block social app like facebook, tinder</span></li><li><span>openappid-streaming_media.rule: To block video streaming app like Youtube, Vimeo</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/dbr0f42.png" /></li><li><span>You can click on the rule itself to view/allow/restrict app that you want (default is restrict all app on list)</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/6hbzrLM.png" /></li><li><span>Click Save</span></li></ul></li></ul></li><li><span>WAN Preporcs Tab :</span><ul><li><span>Enable Performance Stats : If you wanna have logging in depth details through the rules.</span></li><li><span>Auto Rule Disable : Enabled</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/10uQdV9.jpg" /></li><li><span>Application ID Detection: Enabled - Use OpenAppID to detect various applications.</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/4h1CVY0.jpg" /></li><li><span>Click Save</span></li></ul></li></ul><h3 id="Testing1" data-id="Testing"><span>Testing</span></h3><p><span>Services &gt; Snort &gt; Alerts</span><br /><span>Whenever a user use PC or Youtube App, it will show alert</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/yQUYMFI.png" /><br /><span>From what I experiment, Snort don&acirc;&euro;&trade;t completed block services like PFBlockerNG but instead it limit the connection so much to the point user can not load the site or play video</span><br /><img alt="" loading="lazy" src="https://i.imgur.com/720iwxT.png" /><br /><img alt="" loading="lazy" src="https://i.imgur.com/jCM1YQQ.png" /></p></div>

<div class="ui-toc dropup unselectable hidden-print" style="display:none;"><div class="pull-right dropdown"><div class="toc"><ul class="nav"><li><a title="PFsense IP and DNS filter with PFBLOCKERNG / Application Filter with Snort and OpenAppID" href="#PFsense-IP-and-DNS-filter-with-PFBLOCKERNG--Application-Filter-with-Snort-and-OpenAppID">PFsense IP and DNS filter with PFBLOCKERNG / Application Filter with Snort and OpenAppID</a><ul class="nav"><li><a title="Source" href="#Source">Source</a></li><li><a title="Requirement" href="#Requirement">Requirement</a><ul class="nav"><li><a title="System Requirement" href="#System-Requirement">System Requirement</a></li></ul></li><li><a title="Install PFBLOCKERNG" href="#Install-PFBLOCKERNG">Install PFBLOCKERNG</a><ul class="nav"><li><a title="Install pfBlockerNG-deval" href="#Install-pfBlockerNG-deval">Install pfBlockerNG-deval</a></li></ul></li><li><a title="Configure PFBLOCKERNG" href="#Configure-PFBLOCKERNG">Configure PFBLOCKERNG</a><ul class="nav"><li><a title="Basic Setup" href="#Basic-Setup">Basic Setup</a></li><li><a title="IP Block (Optional)" href="#IP-Block-Optional">IP Block (Optional)</a></li><li><a title="DNS Block Basic" href="#DNS-Block-Basic">DNS Block Basic</a></li><li><a title="DNS Block Advance" href="#DNS-Block-Advance">DNS Block Advance</a></li><li><a title="Testing" href="#Testing">Testing</a></li><li><a title="Note" href="#Note">Note</a></li></ul></li><li><a title="Install Snort" href="#Install-Snort">Install Snort</a><ul class="nav"><li><a title="Install Snort" href="#Install-Snort1">Install Snort</a></li></ul></li><li><a title="Configure Snort" href="#Configure-Snort">Configure Snort</a><ul class="nav"><li><a title="Basic Setup" href="#Basic-Setup1">Basic Setup</a></li><li><a title="Configure Rules to block Application" href="#Configure-Rules-to-block-Application">Configure Rules to block Application</a></li><li><a title="Testing" href="#Testing1">Testing</a></li></ul></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div><ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel"></ul></div></div>

<div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null=""><div class="toc"><ul class="nav"><li><a title="PFsense IP and DNS filter with PFBLOCKERNG / Application Filter with Snort and OpenAppID" href="#PFsense-IP-and-DNS-filter-with-PFBLOCKERNG--Application-Filter-with-Snort-and-OpenAppID">PFsense IP and DNS filter with PFBLOCKERNG / Application Filter with Snort and OpenAppID</a><ul class="nav"><li><a title="Source" href="#Source">Source</a></li><li><a title="Requirement" href="#Requirement">Requirement</a><ul class="nav"><li><a title="System Requirement" href="#System-Requirement">System Requirement</a></li></ul></li><li><a title="Install PFBLOCKERNG" href="#Install-PFBLOCKERNG">Install PFBLOCKERNG</a><ul class="nav"><li><a title="Install pfBlockerNG-deval" href="#Install-pfBlockerNG-deval">Install pfBlockerNG-deval</a></li></ul></li><li><a title="Configure PFBLOCKERNG" href="#Configure-PFBLOCKERNG">Configure PFBLOCKERNG</a><ul class="nav"><li><a title="Basic Setup" href="#Basic-Setup">Basic Setup</a></li><li><a title="IP Block (Optional)" href="#IP-Block-Optional">IP Block (Optional)</a></li><li><a title="DNS Block Basic" href="#DNS-Block-Basic">DNS Block Basic</a></li><li><a title="DNS Block Advance" href="#DNS-Block-Advance">DNS Block Advance</a></li><li><a title="Testing" href="#Testing">Testing</a></li><li><a title="Note" href="#Note">Note</a></li></ul></li><li><a title="Install Snort" href="#Install-Snort">Install Snort</a><ul class="nav"><li><a title="Install Snort" href="#Install-Snort1">Install Snort</a></li></ul></li><li><a title="Configure Snort" href="#Configure-Snort">Configure Snort</a><ul class="nav"><li><a title="Basic Setup" href="#Basic-Setup1">Basic Setup</a></li><li><a title="Configure Rules to block Application" href="#Configure-Rules-to-block-Application">Configure Rules to block Application</a></li><li><a title="Testing" href="#Testing1">Testing</a></li></ul></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer=""></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer=""></script>

<script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>



              </div>
          </div>

          <!-- Sidebar -->
  <div id="sidebar">
    <div class="inner">

      <!-- Search -->
        <section id="search" class="alt">
          <form method="post" action="#">
            <input type="text" name="query" id="query" placeholder="Search" />
          </form>
        </section>

      <!-- Menu -->
        <nav id="menu">
          <header class="major">
            <h2>Menu</h2>
          </header>
          <ul>
            <li><a href="/index.html">Homepage</a></li>
            <li><a href="/aboutme.html">About Me</a></li>
            <li><a href="/generic.html">Generic</a></li>
            <li><a href="/elements.html">Elements</a></li>
            <li>
              <span class="opener">CCDC & CPTC 2021 <br />Summer Trainning<br /></span>
              <ul>
                <li><a href="#">CPTC</a></li>
                <li><a href="#">CCDC</a></li>
              </ul>
            </li>
            <li>
              <span class="opener">CCDC 2021</span>
              <ul>
                <li><a href="#">Lorem Dolor</a></li>
                <li><a href="#">Ipsum Adipiscing</a></li>
                <li><a href="#">Tempus Magna</a></li>
                <li><a href="#">Feugiat Veroeros</a></li>
              </ul>
            </li>
            <li>
              <span class="opener">Another Submenu</span>
              <ul>
                <li><a href="#">Lorem Dolor</a></li>
                <li><a href="#">Ipsum Adipiscing</a></li>
                <li><a href="#">Tempus Magna</a></li>
                <li><a href="#">Feugiat Veroeros</a></li>
              </ul>
            </li>
          </ul>
        </nav>

      <!-- Section 
        <section>
          <header class="major">
            <h2>Ante interdum</h2>
          </header>
          <div class="mini-posts">
            <article>
              <a href="#" class="image"><img src="assets/images/pic07.jpg" alt="" /></a>
              <p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
            </article>
            <article>
              <a href="#" class="image"><img src="assets/images/pic08.jpg" alt="" /></a>
              <p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
            </article>
            <article>
              <a href="#" class="image"><img src="assets/images/pic09.jpg" alt="" /></a>
              <p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
            </article>
          </div>
          <ul class="actions">
            <li><a href="#" class="button">More</a></li>
          </ul>
        </section> -->

      <!-- Section -->
        <section>
          <header class="major">
            <h2>Get in touch</h2>
          </header>
          <p>Please contact me using the info below. I'm alway happy to connect and make new friend</p></p>
          <ul class="contact">
            <li class="fa-envelope-o">thehoang1920@gmail.com</li>
            <li class="fa-home"><a href="https://www.linkedin.com/in/thehoang1920/">https://www.linkedin.com/in/<br />
            thehoang1920/<br /></a></li> 
            <!--
            <li class="fa-envelope-o"><a href="#">youremailaddress@gmail.com</a></li>
            <li class="fa-phone">(716) 555-5555</li> -->
            <!--<li class="fa-home">1234 Somewhere Road<br />
            Nashville, TN 55555<br />
            United States of America</li> -->
          </ul>
        </section>

      <!-- Footer -->
        <footer id="footer">
          <p class="copyright">&copy; Editorial. All rights reserved. Demo Images: <a href="https://unsplash.com">Unsplash</a>. Design: <a href="https://html5up.net">HTML5 UP</a>. Jekyll integration: <a href="https://andrewbanchi.ch">Andrew Banchich</a>.</p>
        </footer>

    </div>
  </div>


      </div>

      <!-- Scripts -->
  <script src="/assets/js/jquery.min.js"></script>
  <script src="/assets/js/skel.min.js"></script>
  <script src="/assets/js/util.js"></script>
  <!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
  <script src="/assets/js/main.js"></script>


</body>

</html>
